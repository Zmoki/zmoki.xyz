---
import BaseLayout from "./BaseLayout.astro";
import type { CollectionEntry } from "astro:content";
import { Time } from "@zmoki/shared-components";

export interface Props {
  title: string;
  description?: string;
  publishDate: Date;
  contentModifiedDate: Date;
  prevPost?: CollectionEntry<"feed"> | null;
  nextPost?: CollectionEntry<"feed"> | null;
}

const { title, description, publishDate, contentModifiedDate, prevPost, nextPost } = Astro.props;
const isContentModified = contentModifiedDate.getTime() > publishDate.getTime();
---

<BaseLayout title={title} description={description}>
  <article class="space-y-4">
    <!-- Post Header -->
    <header
      class="flex flex-col items-center gap-6 rounded-xl bg-white p-16 text-center text-2xl shadow-sm"
    >
      <h1 class="leading-tighter text-6xl font-semibold">
        {title}
      </h1>
      {description && <p>{description}</p>}
      <p
        class="order-first flex flex-row gap-4 align-middle font-mono text-sm uppercase text-gray-500"
      >
        <Time datetime={publishDate} />
        {
          isContentModified && (
            <em>
              Updated
              <Time datetime={contentModifiedDate} />
            </em>
          )
        }
      </p>
    </header>

    <!-- Post Content -->
    <div
      class="prose prose-2xl prose-headings:font-semibold max-w-none rounded-xl bg-white px-32 py-16 shadow-sm"
    >
      <slot />
    </div>

    <!-- About Author -->
    <aside class="space-y-2 rounded-xl bg-[#ff66e3] p-16 text-xl tracking-tighter shadow-sm">
      <h2 class="pb-4 text-4xl font-semibold">About the Author</h2>
      <p class="[&_a]:text-[#ffd0f6]">
        What do a software engineer, a contemporary artist, and a neurodivergent researcher have in
        common? They're all me, Zarema Khalilova. This post is one piece of my digital garden, where
        I explore the connections between all my different worlds. You can find the bigger picture
        in <a href="/feed/about-me/">Map of Me.</a>
      </p>
    </aside>

    <!-- Navigation -->
    <nav class="[&_a]:!text-gray-900 [&_a]:!no-underline hover:[&_a]:!no-underline">
      <div class="grid grid-cols-1 gap-4 text-2xl sm:grid-cols-2">
        <!-- Previous Post -->
        {
          prevPost ? (
            <a
              href={`/feed/${prevPost.slug}/`}
              class="group flex items-start gap-3 rounded-xl bg-white p-8 shadow-sm transition-colors"
            >
              <svg
                class="mt-1 h-4 w-4 text-gray-400 group-hover:text-gray-600"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 19l-7-7 7-7"
                />
              </svg>
              <div class="min-w-0 flex-1">
                <div class="text-sm text-gray-500">Previous</div>
                <div class="group-hover:text-accent-light">{prevPost.data.title}</div>
              </div>
            </a>
          ) : (
            <div class="h-[72px]" />
          )
        }

        <!-- Next Post -->
        {
          nextPost ? (
            <a
              href={`/feed/${nextPost.slug}/`}
              class="group flex items-start gap-3 rounded-xl bg-white p-8 shadow-sm transition-colors"
            >
              <div class="min-w-0 flex-1 text-right">
                <div class="text-sm text-gray-500">Next</div>
                <div class="group-hover:text-accent-light">{nextPost.data.title}</div>
              </div>
              <svg
                class="mt-1 h-4 w-4 text-gray-400 group-hover:text-gray-600"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5l7 7-7 7"
                />
              </svg>
            </a>
          ) : (
            <div class="h-[72px]" />
          )
        }
      </div>
    </nav>
  </article>
</BaseLayout>
