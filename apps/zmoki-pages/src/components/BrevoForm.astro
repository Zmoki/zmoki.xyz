---
export interface Props {
  brevoFormId: string;
  buttonText?: string;
}

const defaultButtonText = "Subscribe";
const { brevoFormId, buttonText = defaultButtonText } = Astro.props;
---

<!-- Main form -->
<form
  id="brevo-form"
  method="POST"
  action={`https://${import.meta.env.PUBLIC_BREVO_ACCOUNT_ID}.sibforms.com/serve/${brevoFormId}`}
  class="flex gap-8 rounded-lg bg-white p-8 shadow-md sm:flex-col md:flex-row"
>
  <section class="prose prose-headings:font-serif">
    <slot />
  </section>

  <section class="flex flex-col gap-2">
    <!-- Email input -->
    <label for="EMAIL" class="text-lg font-medium">Email</label>
    <input
      type="email"
      id="EMAIL"
      name="EMAIL"
      placeholder="your@email.com"
      required
      class="w-80 rounded-sm border border-gray-300 p-2 text-lg"
    />

    <!-- Captcha -->
    <div
      class="cf-turnstile g-recaptcha"
      data-sitekey={import.meta.env.PUBLIC_CLOUDFLARE_TURNSTILE_SITE_KEY}
      data-size="flexible"
      data-language="en"
    >
    </div>

    <!-- Submit button -->
    <button
      type="submit"
      class="bg-accent-light hover:bg-accent-light/80 rounded-sm px-4 py-2 font-medium text-white"
    >
      {buttonText}
    </button>

    <!-- Hidden inputs -->
    <input type="text" name="email_address_check" value="" style="display: none;" />
    <input type="hidden" name="locale" value="en" />
  </section>
</form>

<script src="https://challenges.cloudflare.com/turnstile/v0/api.js" async defer is:inline></script>
