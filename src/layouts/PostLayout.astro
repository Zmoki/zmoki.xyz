---
import BaseLayout from "./BaseLayout.astro";
import type { CollectionEntry } from "astro:content";
import Time from "../components/Time.astro";

export interface Props {
  title: string;
  description?: string;
  publishDate: Date;
  contentModifiedDate: Date;
  prevPost?: CollectionEntry<"feed"> | null;
  nextPost?: CollectionEntry<"feed"> | null;
}

const { title, description, publishDate, contentModifiedDate, prevPost, nextPost } = Astro.props;
const isContentModified = contentModifiedDate.getTime() > publishDate.getTime();
---

<BaseLayout title={title} description={description} accentColor="blue">
  <article class="space-y-4">
    <!-- Post Header -->
    <header
      class="flex flex-col gap-6 rounded-xl bg-slate-50 px-4 py-8 outline-dashed outline-8 -outline-offset-2 outline-[#1a9eec] md:items-center md:p-16 md:text-center lg:p-20"
    >
      <h1 class="text-5xl font-semibold xl:text-6xl" set:html={title} />
      {description && <p class="text-2xl xl:text-3xl" set:html={description} />}
      <p
        class="order-first flex flex-col gap-2 font-mono text-xs uppercase tracking-normal opacity-70 md:flex-row lg:gap-4 xl:text-sm"
      >
        <span>Published on <Time datetime={publishDate} /></span>
        {
          isContentModified && (
            <span>
              [updated on <Time datetime={contentModifiedDate} />]
            </span>
          )
        }
      </p>
    </header>

    <!-- Post Content -->
    <div
      class="prose prose-xl max-w-none rounded-xl bg-slate-50 px-4 py-8 shadow-md xl:prose-2xl prose-headings:font-semibold md:p-16 xl:px-28 xl:py-16"
    >
      <slot />
    </div>

    <!-- About Author -->
    <aside
      class="space-y-2 rounded-xl bg-slate-50 px-4 py-8 leading-normal text-myblue-900 shadow-md md:bg-[#f20098] md:p-16 md:text-slate-50 xl:p-20"
    >
      <h2 class="pb-4 text-3xl font-medium xl:text-4xl">Written by Zarema Khalilova</h2>
      <p>
        I'm a software engineer, a contemporary artist, and a neurodivergent researcher. This post
        is one piece of my <a
          href="/feed/2-why-im-building-a-digital-garden/"
          class="border-b-4 border-dotted border-current">digital&nbsp;garden</a
        >, where I explore the connections between all my different worlds. You can find the bigger
        picture on the <a href="/feed/1-about-me/" class="border-b-4 border-dotted border-current"
          >map&nbsp;of&nbsp;me</a
        > post.
      </p>
    </aside>

    <!-- Navigation -->
    <nav class="grid w-full grid-cols-1 gap-4 md:grid-cols-2">
      <!-- Previous Post -->
      {
        prevPost && (
          <a
            href={`/feed/${prevPost.slug}/`}
            class="flex flex-col gap-2 rounded-xl border-l-8 border-solid border-[#0098f2] bg-white px-6 pb-10 pt-8 shadow-md"
          >
            <div class="font-mono text-sm uppercase tracking-normal opacity-70">Previous</div>
            <div class="text-2xl font-medium leading-normal">
              <span
                set:html={prevPost.data.title}
                class="border-b-4 border-dotted border-current"
              />
            </div>
          </a>
        )
      }

      <!-- Next Post -->
      {
        nextPost && (
          <a
            href={`/feed/${nextPost.slug}/`}
            class="flex flex-col gap-2 rounded-xl border-r-8 border-solid border-[#0098f2] bg-white px-6 pb-10 pt-8 text-right shadow-md md:col-start-2"
          >
            <div class="font-mono text-sm uppercase tracking-normal opacity-70">Next</div>
            <div class="text-2xl font-medium leading-normal">
              <span
                set:html={nextPost.data.title}
                class="border-b-4 border-dotted border-current"
              />
            </div>
          </a>
        )
      }
    </nav>
  </article>
</BaseLayout>
